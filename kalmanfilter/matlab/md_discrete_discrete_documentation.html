<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KalmanFilter: Discrete-Discrete Extended Kalman filter</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KalmanFilter
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Discrete-Discrete Extended Kalman filter </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Here we will describe the discrete discrete Extended Kalman filter that is of the square root flavour. Square root does not change the math behind the algorithm, but ensures that numerical rounding errors that are natural to a computer do not prevent the computed covariance matrices maintaining their property of being positive semi definite. For a linear model, the Extended Kalman Filter is equivalent to a regular Kalman filter. Check out this <a href="https://uwspace.uwaterloo.ca/bitstream/handle/10012/14740/Zonov_Stanislav.pdf">thesis</a> - chapter 3 for a detailed explanation.</p>
<p>For the discrete-discrete Kalman filter the state evolves discretely and the measurements are discrete in time. The code is in <code>matlab_implementation/discrete_discrete</code> of <a href="https://github.com/mannyray/KalmanFilter">https://github.com/mannyray/KalmanFilter</a>. The function header in <code>ddkef.m</code> is:</p>
<div class="fragment"><div class="line">function [estimates, covariances ] =  ddekf(f_func,jacobian_func,dt_between_measurements,start_time,state_count,sensor_count,measurement_count,C,Q_root,R_root,P_0_root,x_0, measurements)</div></div><!-- fragment --><p>For those familiar with the Kalman filter and notation are familiar with the naming of the variables. However, to be extra sure it is always best to run <code>help ddekf</code>. We will break down an example below.</p>
<h2>Example 1</h2>
<p>The example is located in <code><a class="el" href="logistic_8m.html">matlab_implementation/discrete_discrete/examples/logistic.m</a></code>. You can <code>cd</code> into the directory and then run <code>logistic</code> or do it step by step as described below. First set the seed and include the path to <code>matlab_implementation/discrete_discrete</code>:</p>
<div class="fragment"><div class="line">clear all;</div><div class="line">%include code </div><div class="line">addpath(&#39;..&#39;)</div><div class="line"></div><div class="line">%setting the seed for repetition of experiment </div><div class="line">isOctave = exist(&#39;OCTAVE_VERSION&#39;, &#39;builtin&#39;) ~= 0;</div><div class="line">if isOctave==true</div><div class="line">    randn(&quot;seed&quot;,1);</div><div class="line">else</div><div class="line">    rng(1);</div><div class="line">end</div></div><!-- fragment --><p>Consider the nonlinear discrete logistic growth model. The continuous example can be found in <code>CD-EKF</code> tab.</p>
<div class="fragment"><div class="line">%define discrete logistic growth model and its jacobian</div><div class="line">rate = 0.01;</div><div class="line">max_pop = 100;</div><div class="line">next_func = @(x,t) x + rate.*x.*(1 - x/max_pop) + 0.*t;%time independent</div><div class="line">jacobian_func = @(x,t) 1 + rate - (2*rate*x)/max_pop  + 0.*t;</div></div><!-- fragment --><p>Set the time between each state evolution and the noise covariance and measurement matrices:</p>
<div class="fragment"><div class="line">%in this model the time is only necessary</div><div class="line">%for plotting an interpreting the results.</div><div class="line">outputs = 1000;</div><div class="line">t_start = 0;</div><div class="line">t_final = 10;</div><div class="line">dt = (t_final - t_start)/outputs;</div><div class="line"></div><div class="line">%discrete noise covariance</div><div class="line">Q_d = 1;</div><div class="line">%sensor noise covariance</div><div class="line">R_d = 3;</div><div class="line">%measurement matrix</div><div class="line">C = 1;</div><div class="line"></div><div class="line">state_count = 1; </div><div class="line">sensor_count = 1;</div></div><!-- fragment --><p>Set the initial estimates, covariances as well as generate data in order to run the filter:</p>
<div class="fragment"><div class="line">%model results if there was no process noise</div><div class="line">ideal_data = zeros(state_count,outputs);</div><div class="line">%actual data (with process noise) </div><div class="line">process_noise_data = zeros(state_count,outputs);</div><div class="line">%noisy measurements of actual data</div><div class="line">measurements = zeros(sensor_count,outputs);</div><div class="line"></div><div class="line">%initial estimate and covariance</div><div class="line">%the initial estimate in this case</div><div class="line">%matches the actual data</div><div class="line">x_0 = max_pop/2;</div><div class="line">P_0 = 1;</div><div class="line"></div><div class="line">%initial condition for ideal</div><div class="line">%and real process data</div><div class="line">x = x_0;</div><div class="line">x_noise = x_0;</div><div class="line"></div><div class="line">%generate the data</div><div class="line">for ii=1:outputs</div><div class="line">    x = next_func(x,ii);</div><div class="line">    ideal_data(:,ii) = x;</div><div class="line"></div><div class="line">    x_noise = next_func(x_noise,0) + chol(Q_d)&#39;*randn(state_count,1);</div><div class="line">    process_noise_data(:,ii) = x_noise;</div><div class="line">    measurements(ii) = C*x_noise + chol(R_d)&#39;*randn(sensor_count,1);</div><div class="line">end</div></div><!-- fragment --><p>Filter the data:</p>
<div class="fragment"><div class="line">%filter the noisy measurements</div><div class="line">[estimates, covariances] = ddekf(next_func,jacobian_func,dt,t_start,state_count,...</div><div class="line">    sensor_count,outputs,C,chol(Q_d)&#39;,chol(R_d)&#39;,chol(P_0)&#39;,x_0, measurements);</div></div><!-- fragment --><p>Plot the results:</p>
<div class="fragment"><div class="line">%compare the measurements, estimates and true state.</div><div class="line">%The ideal data is not plotted and is only for reference.</div><div class="line">time = 0:dt:(outputs-1)*dt;</div><div class="line">h = figure;</div><div class="line">hold on;</div><div class="line">plot(time,measurements); </div><div class="line">plot(time,process_noise_data);</div><div class="line">plot(time,estimates(1:end-1));</div><div class="line">legend(&#39;Measurement&#39;,&#39;Real data&#39;,&#39;Estimate&#39;);</div><div class="line">xlabel(&#39;Time&#39;)</div><div class="line">ylabel(&#39;Population&#39;)</div><div class="line"></div><div class="line">h = figure;</div><div class="line">hold on;</div><div class="line">limit = 100;</div><div class="line">plot(time(1:limit),measurements(1:limit),&#39;LineWidth&#39;,2); </div><div class="line">plot(time(1:limit),process_noise_data(1:limit),&#39;LineWidth&#39;,2);</div><div class="line">plot(time(1:limit),estimates(1:limit),&#39;LineWidth&#39;,2);</div><div class="line">legend(&#39;Measurement&#39;,&#39;Real data&#39;,&#39;Estimate&#39;);</div><div class="line">xlabel(&#39;Time&#39;)</div><div class="line">ylabel(&#39;Population&#39;)</div></div><!-- fragment --><p>to produce (in Octave)</p>
<div class="image">
<img src="assets/discrete_discrete/examples/logistic1.png" alt="drawing2" style="width:80%;max-width:600px;"/>
</div>
<div class="image">
<img src="assets/discrete_discrete/examples/logistic2.png" alt="drawing2" style="width:80%;max-width:600px;"/>
</div>
<h2>Example 2</h2>
<p>The example is located in <code><a class="el" href="linear_8m.html">matlab_implementation/discrete_discrete/examples/linear.m</a></code> and has a model with two states. The script is very similar to the one in the previous example. The result produced is</p>
<div class="fragment"><div class="line">ans =</div><div class="line"></div><div class="line">   5.0540e-07   2.4509e-08</div><div class="line">   2.4509e-08   4.9806e-07</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 21 2020 01:28:33 for KalmanFilter by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
